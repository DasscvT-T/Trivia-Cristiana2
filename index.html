<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Trivia Cristiana — Versión Final Estable</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body { font-family: Arial, sans-serif; background:#f2f2f2; padding:18px; color:#0f172a }
  .wrap{max-width:920px;margin:0 auto}
  .card { background:white; padding:18px; margin-bottom:14px; border-radius:10px; box-shadow:0 6px 18px rgba(2,6,23,0.06)}
  h1,h2{margin:6px 0}
  textarea,input{width:100%;box-sizing:border-box;padding:8px;border-radius:8px;border:1px solid #d1d5db}
  button{padding:8px 12px;border-radius:8px;border:none;background:#2563eb;color:#fff;cursor:pointer}
  button.secondary{background:#0ea5a4}
  .players-list{display:flex;gap:10px;flex-wrap:wrap}
  .player-card{background:#eef2ff;padding:8px;border-radius:8px}
  .options{display:flex;flex-direction:column;gap:8px;margin-top:10px}
  .option{padding:14px;border-radius:10px;border:2px solid #94a3b8;background:#ffffff;cursor:pointer;text-align:left;font-size:18px;font-weight:600;display:block;color:#0f172a}
  .option.correct{background:#ecfdf5;border-color:#10b981}
  .option.wrong{background:#fff1f2;border-color:#ef4444}
  table{width:100%;border-collapse:collapse}
  td,th{padding:8px;border-bottom:1px solid #eee;text-align:left}
  @media(max-width:600px){.players-list{flex-direction:column}}
</style>
</head>
<body>
<div class="wrap">
  <h1>Trivia Cristiana </h1>

  <div class="card" id="setupCard">
    <h2>Registrar jugadores</h2>
    <p>Escribe un nombre por línea (mínimo 1 jugador)</p>
    <textarea id="nombres" rows="4" placeholder="Ejemplo:\nJosué\nMaría\nKevin"></textarea>
    <div style="margin-top:8px;display:flex;gap:8px">
      <button id="guardarBtn">Guardar jugadores</button>
      <button id="clearBtn" class="secondary" type="button">Limpiar</button>
    </div>
    <p style="margin-top:8px"><strong>Jugadores registrados:</strong></p>
    <div id="listaJugadores" class="players-list"></div>
  </div>

  <div class="card">
    <h2>Juego</h2>
    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <label>Categoria:</label>
      <select id="categoriaSelect">
        <option value="media">Media</option>
      </select>
      <button id="startBtn" class="secondary">Comenzar / Siguiente pregunta</button>
    </div>

    <div id="turnoInfo" style="margin-top:12px">
      <strong>Turno:</strong> <span id="jugadorActual">-</span>
    </div>

    <div id="questionArea" style="margin-top:12px;display:none">
      <div id="pregunta" style="font-weight:700"></div>
      <div id="referencia" style="color:#374151;margin-top:6px;font-size:0.95rem"></div>
      <div class="options" id="opciones"></div>
      <div id="autoInfo" style="margin-top:8px;color:#6b7280;font-size:0.9rem"></div>
    </div>
  </div>

  <div class="card">
    <h2>Marcador</h2>
    <table>
      <thead><tr><th>Jugador</th><th>Puntos</th></tr></thead>
      <tbody id="scoreboard"></tbody>
    </table>
  </div>
</div>

<script>
// Preguntas
const preguntas = {
media:[ 
  {q:'¿Quién abrió el Mar Rojo?', options:['Moisés','Josué','Aarón','Elías'], a:0, ref:'Éxodo 14'},
{q:'¿Quién fue el primer rey de Israel?', options:['David','Saúl','Salomón','Samuel'], a:1, ref:'1 Samuel 10'},
{q:'¿Quién fue el hombre más fuerte de la Biblia?', options:['Gedeón','David','Sansón','Saúl'], a:2, ref:'Jueces 16'},
{q:'¿Quién escribió la mayoría de las cartas del Nuevo Testamento?', options:['Pedro','Juan','Pablo','Santiago'], a:2},
{q:'¿Quién fue el primer mártir cristiano?', options:['Santiago','Esteban','Felipe','Bernabé'], a:1, ref:'Hechos 7'},
{q:'¿Quién traicionó a Jesús?', options:['Pedro','Judas','Tomás','Andrés'], a:1},
{q:'¿Qué discípulo dudó de la resurrección de Jesús?', options:['Pedro','Juan','Tomás','Felipe'], a:2},
{q:'¿Quién interpretó sueños en Egipto?', options:['Daniel','José','Samuel','Moisés'], a:1},
{q:'¿Qué rey pidió sabiduría a Dios?', options:['David','Salomón','Ezequías','Josías'], a:1, ref:'1 Reyes 3'},
{q:'¿Qué profeta confrontó a los profetas de Baal?', options:['Eliseo','Elías','Jeremías','Oseas'], a:1, ref:'1 Reyes 18'},

{q:'¿Quién caminó sobre el agua junto a Jesús?', options:['Pedro','Juan','Andrés','Santiago'], a:0},
{q:'¿Quién fue el primer hombre creado?', options:['Adán','Abel','Noé','Set'], a:0},
{q:'¿Quién mató a Abel?', options:['Set','Caín','Lamec','Adán'], a:1},
{q:'¿Cuántos mandamientos dio Dios a Moisés?', options:['5','7','10','12'], a:2},
{q:'¿Quién construyó el templo de Jerusalén?', options:['Saúl','David','Salomón','Nehemías'], a:2},

{q:'¿Cuál profeta fue llevado al cielo en un carro de fuego?', options:['Elías','Eliseo','Enoc','Isaías'], a:0},
{q:'¿Quién mató a Goliat?', options:['Salomón','Samuel','David','Saúl'], a:2},
{q:'¿Cuál discípulo era recaudador de impuestos?', options:['Juan','Mateo','Felipe','Simón'], a:1},
{q:'¿Quién vio al Señor en un zarzal ardiendo?', options:['Moisés','Jacob','Isaac','Aarón'], a:0},

{q:'¿Quién pidió una señal con un vellón mojado?', options:['Gedeón','Sansón','David','Saúl'], a:0},
{q:'¿Qué profeta fue enviado a Nínive?', options:['Miqueas','Jonás','Amós','Nahúm'], a:1},
{q:'¿Quién lloró por la muerte de Lázaro?', options:['Pedro','Jesús','Juan','Marta'], a:1},
{q:'¿Quién interpretó el sueño de Nabucodonosor?', options:['Daniel','Ezequiel','Jeremías','Isaías'], a:0},
{q:'¿Cuál era la esposa de Abraham?', options:['Raquel','Sara','Rebeca','Lea'], a:1},

{q:'¿Qué rey escribió muchos salmos?', options:['Saúl','Salomón','David','Ezequías'], a:2},
{q:'¿Cómo murió Judas?', options:['Lo apedrearon','Se ahorcó','Murió en batalla','Lo crucificaron'], a:1},
{q:'¿Quién ordenó matar a todos los niños menores de dos años?', options:['Herodes','Pilato','César','Anás'], a:0},
{q:'¿Qué profeta vio una zarza que no se consumía?', options:['Samuel','Elías','Moisés','Isaías'], a:2},

{q:'¿Quién fue el padre de Juan el Bautista?', options:['Zacarías','José','Simeón','Natán'], a:0},
{q:'¿Quién fue la madre de Samuel?', options:['Ana','Noemí','Débora','Rut'], a:0},
{q:'¿Quién derrotó a los madianitas con 300 hombres?', options:['Sansón','Gedeón','David','Saúl'], a:1},
{q:'¿Cuál discípulo negó a Jesús?', options:['Andrés','Pedro','Juan','Tomás'], a:1},
{q:'¿Qué apóstol tuvo una visión en la isla de Patmos?', options:['Pablo','Juan','Pedro','Santiago'], a:1},

{q:'¿Quién alimentó a un profeta con cuervos?', options:['Elías','Eliseo','Daniel','Jeremías'], a:0},
{q:'¿Quién tradujo sueños en Babilonia?', options:['Daniel','José','Ezequiel','Zacarías'], a:0},
{q:'¿Quién fue echado en un horno de fuego?', options:['Eliseo','Daniel','Sadrac, Mesac y Abed-nego','Jonás'], a:2},
{q:'¿Quién fue el rey más sabio?', options:['Saúl','David','Salomón','Acab'], a:2},

{q:'¿Quién fue el profeta que confrontó al rey David por su pecado?', options:['Natán','Samuel','Elías','Jeremías'], a:0},
{q:'¿Quién escribió el libro de Apocalipsis?', options:['Pedro','Juan','Pablo','Lucas'], a:1},
{q:'¿Cuál fue el primer milagro de Jesús?', options:['Sanar un ciego','Multiplicar panes','Convertir agua en vino','Resucitar a Lázaro'], a:2},

{q:'¿Quién ayudó a Jesús a cargar la cruz?', options:['Pedro','Simón de Cirene','Juan','Bartolomé'], a:1},
{q:'¿Quién dijo “He peleado la buena batalla”?', options:['Pedro','Juan','Pablo','Santiago'], a:2},
{q:'¿Quién sobrevivió en el foso de los leones?', options:['David','Daniel','Salomón','Pablo'], a:1},
{q:'¿Quién pidió al Señor que “hable, que tu siervo oye”?', options:['Samuel','David','Eliseo','Josué'], a:0},

{q:'¿Quién fue arrebatado al cielo sin ver muerte?', options:['Enoc','Elías','Ambos','Ninguno'], a:2},
{q:'¿Quién fue el profeta que vio serafines en el templo?', options:['Jeremías','Isaías','Ezequiel','Oseas'], a:1},

{q:'¿Qué discípulo escribió dos cartas y cuidó de iglesias?', options:['Pedro','Juan','Judas','Santiago'], a:0},
{q:'¿Quién tuvo un sueño con una escalera al cielo?', options:['Abraham','Jacob','Isaac','Noé'], a:1},
{q:'¿Quién fue vendido por 20 piezas de plata?', options:['José','Daniel','David','Jonás'], a:0},
{q:'¿Quién fue el sacerdote que crió a Samuel?', options:['Elí','Abiatar','Sadoc','Finees'], a:0, ref:'1 Samuel 3'},
{q:'¿Qué rey hizo un reloj retroceder diez grados?', options:['Acaz','Manasés','Ezequías','Uzías'], a:2, ref:'2 Reyes 20'},
{q:'¿Quién perdió su reino por volverse loco?', options:['Beltsasar','Nabucodonosor','Darío','Ciro'], a:1, ref:'Daniel 4'},
{q:'¿Cuál profeta fue aserrado según la tradición judía?', options:['Isaías','Jeremías','Ezequiel','Miqueas'], a:0},
{q:'¿Quién mató a Sisara con una estaca?', options:['Débora','Jael','Rut','Abigail'], a:1, ref:'Jueces 4'},
{q:'¿Cuál profeta compró un cinturón y lo escondió?', options:['Jeremías','Ezequiel','Oseas','Amós'], a:0, ref:'Jeremías 13'},
{q:'¿A quién se le apareció un hombre con una espada desenvainada antes de conquistar Jericó?', options:['Josué','Moisés','Gedeón','Caleb'], a:0},
{q:'¿Qué rey arrancaba páginas del rollo que leía?', options:['Joacim','Zedequías','Manasés','Jeroboam'], a:0, ref:'Jeremías 36'},
{q:'¿Quién dijo: “Me sedujiste, oh Jehová, y fui seducido”?', options:['Isaías','Jeremías','Habacuc','Malaquías'], a:1},
{q:'¿Qué profeta vio ruedas llenas de ojos?', options:['Ezequiel','Daniel','Zacarías','Isaías'], a:0},

{q:'¿Qué juez hizo un voto imprudente sobre su hija?', options:['Gedeón','Sansón','Jefté','Tola'], a:2, ref:'Jueces 11'},
{q:'¿Quién rescató y escondió a Joás en el templo por seis años?', options:['Atalía','Josaba','Noemí','Abigail'], a:1, ref:'2 Reyes 11'},
{q:'¿Quién vio un candelabro de oro y dos olivos?', options:['Ezequiel','Zacarías','Daniel','Miqueas'], a:1},
{q:'¿Cuál profeta fue llamado “hijo del hombre”?', options:['Isaías','Jeremías','Ezequiel','Daniel'], a:2},
{q:'¿Quién fue mordido por una serpiente y no murió?', options:['Pedro','Pablo','Juan','Tomás'], a:1, ref:'Hechos 28'},

{q:'¿Quién dijo: “Desnudo salí del vientre de mi madre”?', options:['Salomón','Job','David','Samuel'], a:1},
{q:'¿Qué mujer aconsejó que dividieran un niño?', options:['Atalía','Mical','La madre falsa','La reina de Sabá'], a:2},
{q:'¿Qué mujer mató a Abimelec arrojándole una piedra de molino?', options:['Una sierva','Una mujer anónima','Jael','Mical'], a:1, ref:'Jueces 9'},
{q:'¿Qué profeta vio un rollo que medía veinte codos?', options:['Zacarías','Oseas','Amós','Jeremías'], a:0},
{q:'¿Quién profetizó un terremoto en los días de Uzías?', options:['Habacuc','Amós','Sofonías','Miqueas'], a:1},

{q:'¿Quién tuvo un asistente llamado Gehazi?', options:['Elías','Eliseo','Oseas','Jonás'], a:1},
{q:'¿Quién interpretó la escritura en la pared?', options:['Daniel','Jeremías','Habacuc','Zacarías'], a:0},
{q:'¿Quién pidió ver la gloria de Dios, y solo vio sus espaldas?', options:['Moisés','Abraham','Elías','Josué'], a:0},
{q:'¿Quién fue advertido de no comer pan ni beber agua en Betel?', options:['El profeta anciano','El profeta joven','Eliseo','Amasías'], a:1, ref:'1 Reyes 13'},
{q:'¿Quién dijo “He aquí la sierva del Señor; hágase conmigo conforme a tu palabra”?', options:['Elisabet','Sara','Ana','María'], a:3},

{q:'¿Qué libro menciona a un rey que tenía 127 provincias?', options:['Ester','Daniel','Esdras','1 Reyes'], a:0},
{q:'¿Quién fue mordido por una serpiente de bronce para sanar?', options:['Nadie la tocaba','Israelitas desobedientes','Solo los sacerdotes','Los levitas'], a:1, ref:'Números 21'},
{q:'¿Qué profeta profetizó sobre el renuevo de Isaí?', options:['Zacarías','Malaquías','Isaías','Ezequiel'], a:2},
{q:'¿Quién encontró un libro de la ley durante una reparación del templo?', options:['Ezequías','Josías','Manasés','Joacim'], a:1},
{q:'¿Quién fue el escriba que ayudó a Esdras?', options:['Neemías','Absalón','Baruc','Artajerjes'], a:0},

{q:'¿Qué rey tuvo un sueño sobre una gigantesca estatua?', options:['Darío','Nabucodonosor','Belsasar','Ciro'], a:1},
{q:'¿Cuál profeta compró un campo en Anatot como señal?', options:['Jeremías','Ezequiel','Isaías','Oseas'], a:0},
{q:'¿Quién fue golpeado hasta morir por no obedecer la instrucción de Saúl?', options:['Doeg','Agag','Aimelec','Gehazi'], a:1},
{q:'¿Qué mujer ungió los pies de Jesús con perfume costoso?', options:['Marta','María de Betania','Salomé','Priscila'], a:1},
{q:'¿Quién tuvo una visión sobre un carnero y un macho cabrío?', options:['Oseas','Zacarías','Ezequiel','Daniel'], a:3},

{q:'¿Quién escribió: “Vanidad de vanidades, todo es vanidad”?', options:['David','Salomón','Job','Asaf'], a:1},
{q:'¿Quién dijo que Dios podía levantar hijos de Abraham aun de las piedras?', options:['Jesús','Juan el Bautista','Pablo','Pedro'], a:1},
{q:'¿Quién maldijo un árbol y se secó?', options:['Elías','Pedro','Jesús','Eliseo'], a:2},
{q:'¿Quién mató un león y luego encontró miel en su carcasa?', options:['David','Sansón','Gedeón','Abner'], a:1},
{q:'¿Quién tuvo una visión de cuatro bestias saliendo del mar?', options:['Daniel','Zacarías','Ezequiel','Isaías'], a:0},

{q:'¿Qué rey fue puesto en prisión por Jeremías?', options:['Sedequías','Joacim','Manasés','Uzías'], a:0},
{q:'¿Quién oyó una voz en su burra?', options:['Balaam','Balac','Agar','Joram'], a:0},
{q:'¿Quién derribó el altar de Baal de su padre?', options:['Gedeón','Sansón','Eliseo','Oseas'], a:0},
{q:'¿Quién escribió una carta a Diotrefes?', options:['Juan','Pedro','Pablo','Judas'], a:0, ref:'3 Juan'},
{q:'¿Quién vio un ángel en el pozo diciendo “¿De dónde vienes?”?', options:['Ana','Sara','Agar','Débora'], a:2},

{q:'¿Quién regresó a Jerusalén con cartas del rey Artajerjes?', options:['Esdras','Daniel','Zorobabel','Josías'], a:0},
{q:'¿Qué profeta fue obligado a casarse con una mujer llamada Gomer?', options:['Oseas','Amós','Joel','Jonás'], a:0},
{q:'¿Quién vio un rollo que se comió y le supo dulce?', options:['Juan','Ezequiel','Daniel','Isaías'], a:0, ref:'Apocalipsis 10'},
{q:'¿Quién dijo que el justo vivirá por su fe?', options:['Habacuc','Isaías','Sofonías','Zacarías'], a:0},
{q:'¿Quién fue el primer hombre llamado “amigo de Dios”?', options:['Moisés','Salomón','Abraham','Noé'], a:2}
  ]
};


let jugadores = [], puntuaciones = {}, turno = 0;
let categoriaActual = 'facil';
let usadas = {facil:new Set(), media:new Set(), dificil:new Set()};
let currentQuestion = null;
let lockAnswer = false;
let autoTimer = null;
const AUTO_SECONDS = 45;

const nombresEl = document.getElementById('nombres');
const guardarBtn = document.getElementById('guardarBtn');
const clearBtn = document.getElementById('clearBtn');
const listaJugadoresEl = document.getElementById('listaJugadores');
const categoriaSelect = document.getElementById('categoriaSelect');
const startBtn = document.getElementById('startBtn');
const jugadorActualEl = document.getElementById('jugadorActual');
const questionArea = document.getElementById('questionArea');
const preguntaEl = document.getElementById('pregunta');
const referenciaEl = document.getElementById('referencia');
const opcionesEl = document.getElementById('opciones');
const scoreboardEl = document.getElementById('scoreboard');
const autoInfoEl = document.getElementById('autoInfo');

function actualizarListaVisual(){
  listaJugadoresEl.innerHTML = '';
  jugadores.forEach((name,i)=>{
    const div = document.createElement('div');
    div.className = 'player-card';
    div.textContent = name + ' — ' + (puntuaciones[name] || 0) + ' pts';
    if(i===turno) div.style.outline = '2px solid #fde68a';
    listaJugadoresEl.appendChild(div);
  });
  actualizarScoreboard();
}

function actualizarScoreboard(){
  scoreboardEl.innerHTML = '';
  jugadores.forEach(name=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${name}</td><td>${puntuaciones[name] ?? 0}</td>`;
    scoreboardEl.appendChild(tr);
  });
}

function registrarJugadores(){
  const texto = nombresEl.value.trim();
  if(!texto){ alert('Escribe al menos un nombre'); return; }
  // split by newlines (handles Windows/Unix)
  jugadores = texto.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
  if(jugadores.length===0){ alert('No hay nombres válidos'); return; }
  puntuaciones = {};
  jugadores.forEach(n=>puntuaciones[n]=0);
  turno = 0;
  usadas = {facil:new Set(), media:new Set(), dificil:new Set()};
  actualizarListaVisual();
  jugadorActualEl.textContent = jugadores[0];
  questionArea.style.display='none';
}

function pickQuestionIndex(cat){
  const pool = preguntas[cat];
  if(!pool || pool.length===0) return -1;
  if(usadas[cat].size >= pool.length) usadas[cat].clear();
  const disp = [];
  pool.forEach((_,i)=>{ if(!usadas[cat].has(i)) disp.push(i); });
  if(disp.length===0) return -1;
  return disp[Math.floor(Math.random()*disp.length)];
}

function loadQuestion(){
  if(jugadores.length===0){ alert('Registra jugadores primero'); return; }
  clearAutoTimer();
  lockAnswer = false;

  const cat = categoriaSelect.value;
  const idx = pickQuestionIndex(cat);
  if(idx < 0){ alert('No hay preguntas disponibles en esta categoría'); return; }
  const q = preguntas[cat][idx];
  usadas[cat].add(idx);
  currentQuestion = q;

  preguntaEl.textContent = q.q;
  referenciaEl.textContent = 'Ref: ' + (q.ref || 'N/A');
  opcionesEl.innerHTML = '';

  q.options.forEach((op,i)=>{
    const btn = document.createElement('button');
    btn.className = 'option';
    btn.type = 'button';
    btn.textContent = op;
    btn.onclick = ()=>handleAnswer(i,btn);
    opcionesEl.appendChild(btn);
  });

  questionArea.style.display = 'block';
  startAutoTimer();
}

function handleAnswer(i, btn){
  if(lockAnswer) return;
  lockAnswer = true;
  clearAutoTimer();
  opcionesEl.querySelectorAll('button').forEach(b=>b.style.pointerEvents='none');

  if(i === currentQuestion.a){
    btn.classList.add('correct');
    const player = jugadores[turno];
    puntuaciones[player] = (puntuaciones[player] || 0) + 1;
  }else{
    btn.classList.add('wrong');
    const correctBtn = opcionesEl.children[currentQuestion.a];
    if(correctBtn) correctBtn.classList.add('correct');
  }

  actualizarListaVisual();

  setTimeout(()=>{
    turno = (turno+1) % jugadores.length;
    jugadorActualEl.textContent = jugadores[turno];
    loadQuestion();
  },1000);
}

function startAutoTimer(){
  let r = AUTO_SECONDS;
  autoInfoEl.textContent = `Se avanzará automáticamente en ${r}s`;

  autoTimer = setInterval(()=>{
    r--;
    autoInfoEl.textContent = `Se avanzará automáticamente en ${r}s`;

    if(r<=0){ clearAutoTimer(); timeoutAdvance(); }
  },1000);
}
function clearAutoTimer(){ if(autoTimer){ clearInterval(autoTimer); autoTimer=null; autoInfoEl.textContent=''; } }

function timeoutAdvance(){
  const correctBtn = opcionesEl.children[currentQuestion.a];
  if(correctBtn) correctBtn.classList.add('correct');
  setTimeout(()=>{
    turno = (turno+1) % jugadores.length;
    jugadorActualEl.textContent = jugadores[turno];
    loadQuestion();
  },800);
}

// Eventos

guardarBtn.onclick = registrarJugadores;
clearBtn.onclick = ()=>{ nombresEl.value=''; jugadores=[]; puntuaciones={}; actualizarListaVisual(); questionArea.style.display='none'; };
startBtn.onclick = loadQuestion;

</script>
</body>
</html>
